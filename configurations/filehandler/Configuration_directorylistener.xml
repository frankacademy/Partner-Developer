<Module	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
		xsi:noNamespaceSchemaLocation="../FrankConfig.xsd">

	<Adapter name="processfile">
		<Receiver name="processfile">
			<DirectoryListener 
				inputFolder="c:\temp\input" 
				inProcessFolder="c:\temp\inprocess" 
				processedFolder="c:\temp\processed" 
				errorFolder="c:\temp\error"
				wildcard="*.csv"
				createFolders="true"
				fileTimeSensitive="true"
				messageType="contents"/>
		</Receiver>

		<Pipeline>
			<Exits>
				<Exit name="READY" state="SUCCESS"  />

			</Exits>
			<CsvParserPipe name="parsecsv" fieldSeparator=";" prettyPrint="true"/>

			<ForEachChildElementPipe name="xmlIterator" elementXPathExpression="csv/record">
                <FixedQuerySender query="INSERT INTO PEOPLE (IDENTIFIER, ACCESSCODE , RECOVERYCODE , FIRSTNAME , LASTNAME , DEPARTMENT , LOCATION) VALUES(?{IDENTIFIER}, ?{ACCESSCODE} , ?{RECOVERYCODE} , ?{FIRSTNAME} , ?{LASTNAME} , ?{DEPARTMENT} , ?{LOCATION})">
                    <Param name="IDENTIFIER"         xpathExpression="record/Indentifier"/>
                    <Param name="ACCESSCODE"   xpathExpression="record/AccessCode"/>
                    <Param name="RECOVERYCODE"    xpathExpression="record/RecoveryCode"/>
                    <Param name="FIRSTNAME"     xpathExpression="record/FirstName"/>
                    <Param name="LASTNAME"       xpathExpression="record/LastName"/>
                    <Param name="DEPARTMENT"          xpathExpression="record/Department"/>
                    <Param name="LOCATION"       xpathExpression="record/location"/>
                </FixedQuerySender>
            </ForEachChildElementPipe>
			
			
		</Pipeline>
	</Adapter>

</Module>